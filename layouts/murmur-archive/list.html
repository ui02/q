{{ define "main" }}

<h1>{{ .Title }}</h1>

{{/* murmur-archive のすべてのページを取得して日付順にソート */}}
{{ $allPages := where .Site.RegularPages "Type" "murmur-archive" }}
{{ $allPages = $allPages.ByDate.Reverse }}

{{/* ページネーション */}}
{{ $paginator := $.Paginate $allPages }}
{{ range $paginator.Pages }}

  <div class="entry">
    
    <!-- 左側: 画像 (最大4枚) -->
    <div class="entry-images">
    {{/* 記事内バンドルの画像をすべて表示 */}}
  {{ range .Resources.Match "*" }}
  {{ if in .MediaType.Type "image" }}
    {{ $img := . }}
    {{ if (default true $.Site.Params.imageProcessing.cover.enabled) }}
      {{ $img = .Fill "200x200" }}
    {{ end }}
    
    <a href="{{ .RelPermalink }}" 
       data-pswp-width="{{ .Width }}" 
       data-pswp-height="{{ .Height }}">
      <img src="{{ $img.RelPermalink }}" width="{{ $img.Width }}" height="{{ $img.Height }}" alt="" loading="lazy">
    </a>
  {{ end }}
{{ end }}

    </div>
    
  <!-- 右側: テキスト -->
    <div class="entry-text">
      {{/* マークダウン本文をHTMLとして表示 */}}
      {{ .Content | safeHTML }}
      <small>{{ .Date.Format "2006/01/02 15:04" }}</small>
    </div>
    
  </div>
{{ end }}

<div class="pagination">
  {{ if $paginator.HasPrev }}
    <a href="{{ $paginator.Prev.URL }}">Prev</a>
  {{ end }}
  {{ if $paginator.HasNext }}
    <a href="{{ $paginator.Next.URL }}">Next</a>
  {{ end }}
</div>

{{ end }}
