{{ define "main" }}

<h1>{{ .Title }}</h1>

{{/* murmur-archive のすべてのページを取得して日付順にソート */}}
{{ $allPages := where .Site.RegularPages "Type" "murmur-archive" }}
{{ $allPages = $allPages.ByDate.Reverse }}

{{/* 年-月でグループ化 */}}
{{ $months := $allPages | groupByDate "2006-01" }}

{{/* 月ごとにページネーション */}}
{{ range $month := $months }}
  <h2>{{ $month.Key }}</h2>

  {{ $paginator := $.Paginate $month.Pages }}
  {{ range $paginator.Pages }}
    <div class="card">

      {{/* 複数画像をすべて表示 */}}
      {{ range .Resources.Match "images/*" }}
        <img src="{{ .RelPermalink }}" alt="">
      {{ end }}

      <div class="text">
        {{/* マークダウン本文をHTMLとして表示（ツイート文全文表示） */}}
        {{ .Content | safeHTML }}
        <small>{{ .Date.Format "2006/01/02 15:04" }}</small>
      </div>
    </div>
  {{ end }}

  <div class="pagination">
    {{ if $paginator.HasPrev }}
      <a href="{{ $paginator.Prev.URL }}">Prev</a>
    {{ end }}
    {{ if $paginator.HasNext }}
      <a href="{{ $paginator.Next.URL }}">Next</a>
    {{ end }}
  </div>
{{ end }}

{{ end }}
